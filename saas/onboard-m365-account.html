<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Cloudneeti Documentation Pages</title>
    <meta name="description" content="Couscous! Put your documentation in a website!">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://docs.cloudneeti.com/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://docs.cloudneeti.com/bower_components/fontawesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://docs.cloudneeti.com/css/prettify.tomorrow-night-eighties.css" rel="stylesheet">
    <link href="https://docs.cloudneeti.com/css/all.min.css" rel="stylesheet">
    
    <!-- W3 cards -->
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">


    <!-- Custom Fonts -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>

    <link rel="icon" type="image/png" href="logo/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="logo/favicon-16x16.png" sizes="16x16" />

    <!-- Google webmasters verification -->
    <meta name="google-site-verification" content="" />

</head>

<body class="">

    <div id="menu" class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <img src="/images/cloudneeti-logo-wide.png" height="70" width="200" >
                <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <div class="navbar-collapse collapse" id="navbar-main">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="https://docs.cloudneeti.com/deployment-guide.html" style="color:#ff9900">Get started</a></li>
                    <li><a href="https://docs.cloudneeti.com/deployment-guide.html"style="color:#ff9900">Install &amp; Configure</a></li>
                    <li>
                        <a href="http://www.cloudneeti.com" target="_blank" style="color:#ff9900">
                            <i class="fa fa-home"></i> Product Portal
                        </a>
                    </li>
                    <li>
                        <a href="https://azuremarketplace.microsoft.com/en-us/marketplace/apps/cloudneeti.cloudneeti_enterpise?tab=Overview" target="_blank" style="color:#ff9900">
                            <i class="fa fa-shopping-cart"></i> Deploy from Marketplace
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

        <div class="row">
        <div class="sidebar-menu col-md-2" >
                <ul class="nav nav-pills nav-stacked">
                                            <li class="">
                            <button class="w3-button w3-gray w3-hover-orange dropdown-btn" style="width:100%;text-align:left;left:5px;margin-top: 10px;">Get started
                                <i class="fa fa-caret-down"></i>
                            </button>
                            <div class="dropdown-container">
                            <a href="https://docs.cloudneeti.com/deployment-guide.html">Get started <i class="fa fa-caret-down"></i> Marketplace</a>
                            <a href="https://docs.cloudneeti.com/saas/deployment-guide.html">Get started <i class="fa fa-caret-down"></i> Saas</a>
                                                        </div>
                        </li>
                                            <li class="">
                            <button class="w3-button w3-gray w3-hover-orange dropdown-btn" style="width:100%;text-align:left;left:5px;margin-top: 10px;">Installation Guide
                                <i class="fa fa-caret-down"></i>
                            </button>
                            <div class="dropdown-container">
                            <a href="https://docs.cloudneeti.com/deployment-guide.html">Installation Guide <i class="fa fa-caret-down"></i> Marketplace</a>
                            <a href="https://docs.cloudneeti.com/saas/deployment-guide.html">Installation Guide <i class="fa fa-caret-down"></i> Saas</a>
                                                        </div>
                        </li>
                                            <li class="">
                            <button class="w3-button w3-gray w3-hover-orange dropdown-btn" style="width:100%;text-align:left;left:5px;margin-top: 10px;">Configuration Guide
                                <i class="fa fa-caret-down"></i>
                            </button>
                            <div class="dropdown-container">
                            <a href="https://docs.cloudneeti.com/configuration.html">Configuration Guide <i class="fa fa-caret-down"></i> Marketplace</a>
                            <a href="https://docs.cloudneeti.com/saas/configuration.html">Configuration Guide <i class="fa fa-caret-down"></i> Saas</a>
                                                        <ul>
                                <li><a href="https://docs.cloudneeti.com/saas/onboard-azure-account.html">Azure</a></li>
                                <li><a href="https://docs.cloudneeti.com/saas/onboard-m365-account.html">Office 365</a></li>
                                <li><a href="https://docs.cloudneeti.com/saas/onboard-aws-account.html">AWS</a></li>
                            </ul>
                                                        </div>
                        </li>
                                            <li class="">
                            <button class="w3-button w3-gray w3-hover-orange dropdown-btn" style="width:100%;text-align:left;left:5px;margin-top: 10px;">Troubleshooting
                                <i class="fa fa-caret-down"></i>
                            </button>
                            <div class="dropdown-container">
                            <a href="https://docs.cloudneeti.com/troubleshooting.html">Troubleshooting <i class="fa fa-caret-down"></i> Marketplace</a>
                            <a href="https://docs.cloudneeti.com/saas/troubleshooting.html">Troubleshooting <i class="fa fa-caret-down"></i> Saas</a>
                                                        </div>
                        </li>
                                            <li class="">
                            <button class="w3-button w3-gray w3-hover-orange dropdown-btn" style="width:100%;text-align:left;left:5px;margin-top: 10px;">Release Summary
                                <i class="fa fa-caret-down"></i>
                            </button>
                            <div class="dropdown-container">
                            <a href="https://docs.cloudneeti.com/release-summary.html">Release Summary <i class="fa fa-caret-down"></i> Marketplace</a>
                            <a href="https://docs.cloudneeti.com/saas/release-summary.html">Release Summary <i class="fa fa-caret-down"></i> Saas</a>
                                                        </div>
                        </li>
                                            <li class="">
                            <button class="w3-button w3-gray w3-hover-orange dropdown-btn" style="width:100%;text-align:left;left:5px;margin-top: 10px;">FAQs
                                <i class="fa fa-caret-down"></i>
                            </button>
                            <div class="dropdown-container">
                            <a href="https://docs.cloudneeti.com/faqs.html">FAQs <i class="fa fa-caret-down"></i> Marketplace</a>
                            <a href="https://docs.cloudneeti.com/saas/faqs.html">FAQs <i class="fa fa-caret-down"></i> Saas</a>
                                                        </div>
                        </li>
                                    </ul>
        </div>

        <section class="main-content col-sm-10 col-lg-10">
            <h2><strong>Pre-requisite:</strong></h2>
<ul>
<li>Must have Office 365 Account </li>
<li>One Azure Subscription</li>
<li>Office Admin should have Office 365 app password <strong>(<a href="./create-app-password.html">Use O365 App Password generation procedure</a>)</strong></li>
<li>Office administrator should have &quot;Enterprise E5&quot; office license</li>
<li>The user running M365 data collector on-boarding script should have a contributor or owner access on a Azure subscription </li>
<li>The user should have Cloudneeti API keys <strong><a href="./api-key-generation.html">(Use Cloudneeti API key generation procedure)</a></strong></li>
<li>M365 data collector on-boarding script should be executed only on Azure CloudShell.</li>
</ul>
<h4 id="keep-below-information-handy">Keep below information handy,</h4>
<ul>
<li>License Id</li>
<li>Account Id </li>
<li>Cloudneeti API Key</li>
<li>Cloudneeti Environment (dev/demo/trial/prod)</li>
<li>Cloudneeti Data Collector service principal Id(created at the time of account onboarding)</li>
<li>Cloudneeti Data Collector service principal Secret (created at the time of account onboarding)</li>
<li>Office Domain Name</li>
<li>Office Tenant Id</li>
<li>Office Administrator Id</li>
<li>Office Office 365 App Password</li>
<li>Azure Subscription Id (where data collector resources to be created)</li>
<li>Data Collector Name </li>
</ul>
<h4><strong>Note:</strong> Follow below steps to get Cloudneeti Account Id and License Id:</h4>
<ol>
<li>
<p>To Get <strong>Cloudneeti Account Id:</strong> </p>
<ul>
<li>Login to Cloudneeti dashboard (For example: &lt;&quot;Cloudneeti Environment&quot;&gt;.cloudneeti.com)</li>
<li>Click on <strong>Settings</strong> option from left side pane and go to <strong>Manage Accounts</strong></li>
<li>And copy Account Id
<img src="../images/image-0f39f0cd-3ae8-406d-8f71-12393e61864f.png" alt="image.png" /></li>
</ul>
</li>
<li>To Get <strong>Cloudneeti License Id:</strong> 
<ul>
<li>Login to Cloudneeti dashboard (For example: &lt;&quot;Cloudneeti Environment&quot;&gt;.cloudneeti.com)</li>
<li>Click on <strong>Settings</strong> option from left side pane and go to <strong>Manage Licenses</strong></li>
<li>And copy License Id with respect to account Id
<img src="../images/image-fd9955ba-37dc-4903-97eb-1100775c4116.png" alt="image.png" />
<h4 id="get-below-information-from-cloudneeti-team">Get Below information from Cloudneeti Team,</h4></li>
<li>M365 data collector provisioning script</li>
<li>M365 data collector artifacts storage name</li>
<li>M365 data collector artifacts storage access key</li>
</ul></li>
</ol>
<h2><strong>M365 data collector provisioning</strong></h2>
<ol>
<li>Login to Azure portal: <a href="https://portal.azure.com">https://portal.azure.com</a></li>
<li>Switch to Azure active directory where you have a subscription with pre-requisite access.</li>
<li>
<p>Open CloudShell,
Click on Cloudshell icon on the navigation bar to open Cloudshell and Choose PowerShell from shell drop down</p>
<IMG src="https://docs.microsoft.com/en-in/azure/cloud-shell/media/overview/overview-bash-pic.png" alt="Bash in Cloud Shell"/>
</li>
<li>Run below commands on CloudShell: 
<pre><code>
# Download Provisioning script
wget https://raw.githubusercontent.com/AvyanConsultingCorp/docs_cloudneeti/master/scripts/Provision-M365DataCollector.ps1 -O Provision-M365DataCollector.ps1</code></pre></li>
</ol>
<h1 id="switch-to-the-user-directory">Switch to the User directory</h1>
<p>cd $User</p>
<pre><code>
**Run provisioning script**</code></pre>
<p>./Provision-M365DataCollector.ps1</p>
<pre><code>Enter the requested information and script will provision the M365 data collector resources. (Below image for reference)

![image.png](../images/image-84462894-9e30-4d92-a030-2d07c0816c9d.png)

### **---OR---**
**Run provisioning script with inline parameters**</code></pre>
<p>./Provision-M365DataCollector.ps1 -CloudneetiLicenseId <Cloudneeti License Id> <code> -CloudneetiAccountId &lt;Cloudneeti Account Id&gt;</code>
-CloudneetiEnvironment <Cloudneeti Environment> <code> -ServicePrincipalId &lt;Cloudneeti Data Collector Service Principal Id&gt;</code>
-ArtifactsName &lt;Cloudneeti office 365 Data Collector Artifact Name&gt; <code> -DataCollectorVersion &lt;Cloudneeti Office 365 Data Collector Version&gt;</code>
-OfficeDomain &lt;Office 365 Domain Name&gt; <code> -OfficeTenantId &lt;Office 365 Tenant Id&gt;</code>
-OfficeAdminId &lt;Office 365 Administator Id&gt; <code> -AzureSubscriptionId &lt;Azure Subscription Id where office 365 data collector resouces will be created&gt;</code>
-DataCollectorName &lt;Office 365 Data Collector Name&gt; `
-Location <Default EastUs2> <Region> </p>
<pre><code>
**Then script execution will prompt you for below details:** (Enter requested information)
- Enter Cloudneeti API Key:
- Enter Cloudneeti Data Collector Service Principal Secret:
- Enter Cloudneeti office 365 Data Collector Artifacts Storage Access Key:
- Enter Office 365 App Password:

## **Post On-boarding Steps:**

#### Apply lock to prevent accidental deletion on Onboarding Resource Group
1. Go to m365 data collector resource group
2. Click on **Locks** under settings
3. Press **Add** button to create resource lock
4. Enter **Lock Name** and select **Lock Type** as Delete
5. Press **OK** to save the lock

   ![image.png](../images/image-c4bdfa9a-9797-4b29-ba5a-d902b8826cdb.png)

#### Modify the automation account schedule 

Set the automation account schedule before the Cloudneeti data collection schedule using the below steps,
1. Go to M365 data collector resource group
2. Select Automation account 
3. Click on **Schedules** under **Shared Resources**
4. Select Schedule
   ![image.png](../images/image-c11021a9-949e-445d-91de-550f3ebd7364.png)

5. Modify the schedule timings and press **Save** button
   ![image.png](../images/image-0f05e4ab-85fb-491f-890a-659b672db7e6.png)</code></pre>
        </section>
    </div>

    
            <footer>
            <div class="container">
                <p>
                    Cloudneeti documentaion pages.
                </p>
            </div>
        </footer>
    

    
        <script src="https://docs.cloudneeti.com/bower_components/jquery/dist/jquery.min.js"></script>
        <script src="https://docs.cloudneeti.com/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
        <script src="https://docs.cloudneeti.com/bower_components/google-code-prettify/src/prettify.js"></script>

        <script>
            $(function() {
                $("section h1").wrap('<div class="page-header" />');
                $("pre").addClass('prettyprint');
                prettyPrint();
            });
        </script>
        <script>
        var dropdown = document.getElementsByClassName("dropdown-btn");
        var i;

        for (i = 0; i < dropdown.length; i++) {
        dropdown[i].addEventListener("click", function() {
            this.classList.toggle("active");
            var dropdownContent = this.nextElementSibling;
            if (dropdownContent.style.display === "block") {
                dropdownContent.style.display = "none";
            } else {
                dropdownContent.style.display = "block";
            }
        });
        }
        </script>
        <!-- Piwik -->
        <script type="text/javascript">
            var _paq = _paq || [];
            _paq.push(['trackPageView']);
            _paq.push(['enableLinkTracking']);
            (function() {
                var u=(("https:" == document.location.protocol) ? "https" : "http") + "://mnapoli.piwikpro.com/";
                _paq.push(['setTrackerUrl', u+'piwik.php']);
                _paq.push(['setSiteId', 2]);
                var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript';
                g.defer=true; g.async=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
            })();
        </script>
        <noscript><p><img src="http://mnapoli.piwikpro.com/piwik.php?idsite=2" style="border:0;" alt="" /></p></noscript>
        <!-- End Piwik Code -->
    
</body>
</html>
